<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>Ajax 1 - è¯·æ±‚çº¯æ–‡æœ¬æ•°æ®</title>
</head>
<body>
	<button id="button">è¯·æ±‚çº¯æ–‡æœ¬</button>
	<br>
	<br>
	<div id="text"></div>
</body>
<script>
	//ç›‘å¬buttonå¯¹è±¡
	var btn = document.getElementById('button');
	btn.addEventListener("click",loadText);
	//å®ç°loadTextæ–¹æ³•
	function loadText(){
		//Asynchronous JavaScript And XML(XMLæ˜¯ä¸€ç§æ•°æ®æ ¼å¼,æ ‡è®°è¯­è¨€)
		//è¯·æ±‚æ–¹å¼ axios / Fetch API / prototype / NODE API / jQuery
		//XMLHttpRequest

		//1.å®ä¾‹åŒ–xhrå¯¹è±¡
		var xhr = new XMLHttpRequest();
		// console.log(xhr.readyState);
		// console.log(xhr);

		//2.é…ç½®å¯¹è±¡ä¿¡æ¯ type url/file asyn(æ˜¯å¦å¼‚æ­¥)
			//åŒæ­¥,ä¸€ä¸ªå•æ‰€ğŸš»ä¸€ä¸ªä¸Šå®Œå¦ä¸€ä¸ªä¸Š
			//å¼‚æ­¥,ä¸¤ä¸ªäººåŒæ—¶ä¸Šä¸¤ä¸ªå•æ‰€ğŸš»
		xhr.open("GET","sample.txt",true);
		// console.log(xhr.readyState);


		//3.æ‰§è¡Œå¤„ç†æ•°æ®çš„ä¸¤ç§æ–¹æ³•
		// xhr.onload = function(){
		// 	// console.log(xhr.readyState);//åªä¼šæ‰“å°4
		// 	// console.log(this.responseText);
		// 	if (this.status == 200) {
		// 		console.log(this.responseText);
		// 	}
		// }

		xhr.onprogress = function(){
			//ç›‘å¬3,åšç”¨æˆ·å¼•å¯¼é¡µé¢
			console.log("åŠ è½½é¡µé¢"+this.readyState);
		}

		xhr.onreadystatechange = function(){
		// 	console.log(xhr.readyState);//ä¼šæ‰“å°234
		// 	console.log(this.responseText);
		// console.log(this.status == 200);//ç½‘ç»œè¿é€š
			if (this.readyState == 4 && this.status == 200) {
				console.log(this.responseText);
				document.getElementById('text').innerHTML = this.responseText;
			}
		}
		//4.å‘é€è¯·æ±‚
		xhr.send();
	}

	/*
		0: è¯·æ±‚æœªåˆå§‹åŒ–
		1: æœåŠ¡å™¨è¿æ¥å·²å»ºç«‹
		2: è¯·æ±‚å·²æ¥æ”¶
		3: è¯·æ±‚å¤„ç†ä¸­
		4: è¯·æ±‚å·²å®Œæˆï¼Œä¸”å“åº”å·²å°±ç»ª

		200 : ok
		404 : é¡µé¢æœªæ‰¾åˆ°

	*/
</script>
</html>